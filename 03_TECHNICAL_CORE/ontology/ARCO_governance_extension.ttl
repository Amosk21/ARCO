@prefix :    <https://arco.ai/ontology/core#> .
@prefix bfo: <http://purl.obolibrary.org/obo/BFO_> .
@prefix cco: <http://www.ontologyrepository.com/CommonCoreOntologies/> .
@prefix ro:  <http://purl.obolibrary.org/obo/RO_> .
@prefix iao: <http://purl.obolibrary.org/obo/IAO_> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:<http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .

<https://arco.ai/ontology/governance>
a owl:Ontology ;
rdfs:label "ARCO Governance Extension — Entailment-First Regulatory Classification" ;
rdfs:comment "Governance, intended use, and regulatory classification layer. AnnexIII1aApplicableSystem is OWL-entailed (not SPARQL pattern-matched) from three gates: capability disposition (reality-side), intended use directive ICE (representation-side, via inverse aboutness), and use scenario directive ICE (representation-side, via inverse aboutness). SPARQL checks are audit-only confirmations." ;
owl:imports <https://arco.ai/ontology/core> .


#################################################################
# 1) ACTORS + ROLES
#################################################################

:ProviderOrganization rdf:type owl:Class ;
  rdfs:label "Provider Organization" ;
  rdfs:subClassOf cco:Organization ;
  rdfs:subClassOf [
    a owl:Restriction ;
    owl:onProperty ro:0000087 ;   # has role
    owl:someValuesFrom :ProviderRole
  ] .

:ProviderRole rdf:type owl:Class ;
  rdfs:label "Provider Role" ;
  rdfs:subClassOf bfo:0000023 .   # Role

#################################################################
# 2) DOCUMENTATION WORKFLOW
#################################################################

:AssessmentDocumentationProcess rdf:type owl:Class ;
  rdfs:label "Assessment Documentation Process" ;
  rdfs:subClassOf bfo:0000015 ; # Process
  rdfs:subClassOf
    [ a owl:Restriction ; owl:onProperty ro:0000057 ; owl:someValuesFrom :System ] ,
    [ a owl:Restriction ; owl:onProperty ro:0000057 ; owl:someValuesFrom :ProviderRole ] ,
    [ a owl:Restriction ; owl:onProperty cco:has_output ; owl:someValuesFrom :AssessmentDocumentation ] .

:AssessmentDocumentation rdf:type owl:Class ;
  rdfs:label "Assessment Documentation" ;
  rdfs:comment "A documentation artifact produced by the assessment documentation process; traceable to the assessed system and the regulatory content applied." ;
  rdfs:subClassOf :InformationOutput ;
  rdfs:subClassOf [
    a owl:Restriction ;
    owl:onProperty iao:0000136 ;  # is about
    owl:someValuesFrom :System
  ] ;
  rdfs:subClassOf [
    a owl:Restriction ;
    owl:onProperty iao:0000136 ;  # is about
    owl:someValuesFrom :RegulatoryContent
  ] .

#################################################################
# 3) CCO DECLARATIONS (local stubs — no full import)
#################################################################

cco:DirectiveInformationContentEntity rdf:type owl:Class ;
  rdfs:label "Directive Information Content Entity" ;
  rdfs:subClassOf iao:0000030 . # Information Content Entity

cco:prescribes rdf:type owl:ObjectProperty ;
  rdfs:label "prescribes" ;
  rdfs:comment "A directive ICE prescribes an entity (process type or continuant) as rule or guide." .

cco:Person rdf:type owl:Class ;
  rdfs:label "Person" ;
  rdfs:subClassOf bfo:0000040 . # Material Entity

cco:Organization rdf:type owl:Class ;
  rdfs:label "Organization" ;
  rdfs:subClassOf bfo:0000027 . # Object Aggregate

#################################################################
# 4) INTENDED USE MODELING (CCO Directive ICE Pattern)
#
# Annex III: "AI systems intended to be used for [process] of
# [affected entities]". Three-gate classification:
#   Gate 1: Capability (reality-side disposition)
#   Gate 2: Intended use (directive ICE prescribes process type)
#   Gate 3: Use scenario (affected entities)
#################################################################

:IntendedUseSpecification rdf:type owl:Class ;
  rdfs:label "Intended Use Specification" ;
  rdfs:comment "A directive ICE that prescribes the process type an AI system is intended to realize. OWL restrictions enforce that it prescribes a process and is about a system." ;
  rdfs:subClassOf cco:DirectiveInformationContentEntity ;
  rdfs:subClassOf [
    a owl:Restriction ;
    owl:onProperty cco:prescribes ;
    owl:someValuesFrom :RemoteBiometricIdentificationProcess
  ] ;
  rdfs:subClassOf [
    a owl:Restriction ;
    owl:onProperty iao:0000136 ;   # is about
    owl:someValuesFrom :System
  ] .

:UseScenarioSpecification rdf:type owl:Class ;
  rdfs:label "Use Scenario Specification" ;
  rdfs:comment "A directive ICE that constrains the realization context: who/what is affected. OWL restrictions enforce aboutness to system and affected role." ;
  rdfs:subClassOf cco:DirectiveInformationContentEntity ;
  rdfs:subClassOf [
    a owl:Restriction ;
    owl:onProperty iao:0000136 ;   # is about
    owl:someValuesFrom :System
  ] ;
  rdfs:subClassOf [
    a owl:Restriction ;
    owl:onProperty iao:0000136 ;   # is about
    owl:someValuesFrom :NaturalPersonRole
  ] .

:RemoteBiometricIdentificationProcess rdf:type owl:Class ;
  rdfs:label "Remote Biometric Identification Process" ;
  rdfs:comment "The process universal regulated under Annex III 1(a): remote biometric identification of natural persons." ;
  rdfs:subClassOf bfo:0000015 . # Process

:NaturalPersonRole rdf:type owl:Class ;
  rdfs:label "Natural Person Role" ;
  rdfs:comment "Legal designation under EU law. Not a biological kind — modeled as a BFO Role." ;
  rdfs:subClassOf bfo:0000023 . # Role

#################################################################
# 5) ANNEX III 1(a) ENTAILMENT CLASS
#
# OWL entailment-first classification: AnnexIII1aApplicableSystem
# membership is INFERRED by the reasoner when all three gates hold.
#
# Gate 1 (reality-side): System has_part some (SystemComponent
#         AND has_disposition some BiometricIdentificationCapability)
# Gate 2 (representation-side): An IntendedUseSpecification
#         is_about this system (via inverse of iao:0000136)
# Gate 3 (representation-side): A UseScenarioSpecification
#         is_about this system (via inverse of iao:0000136)
#
# SPARQL checks are AUDIT ONLY — the classification is an
# OWL entailment, not a pattern match.
#################################################################

:AnnexIII1aApplicableSystem rdf:type owl:Class ;
  rdfs:label "Annex III 1(a) Applicable System" ;
  rdfs:comment "System that meets Annex III 1(a) conditions via capability + intended use + affected category, as OWL entailment." ;
  rdfs:subClassOf :System ;
  owl:equivalentClass [
    rdf:type owl:Class ;
    owl:intersectionOf (
      :System

      # Gate 1 (reality-side): biometric capability via component
      [ rdf:type owl:Restriction ;
        owl:onProperty bfo:0000051 ;                 # has_part
        owl:someValuesFrom [
          rdf:type owl:Class ;
          owl:intersectionOf (
            :SystemComponent
            [ rdf:type owl:Restriction ;
              owl:onProperty ro:0000091 ;            # has_disposition
              owl:someValuesFrom :BiometricIdentificationCapability
            ]
          )
        ]
      ]

      # Gate 2 (representation-side): intended use spec exists about this system
      [ rdf:type owl:Restriction ;
        owl:onProperty [ rdf:type owl:ObjectProperty ; owl:inverseOf iao:0000136 ] ;
        owl:someValuesFrom :IntendedUseSpecification
      ]

      # Gate 3 (representation-side): scenario spec exists about this system
      [ rdf:type owl:Restriction ;
        owl:onProperty [ rdf:type owl:ObjectProperty ; owl:inverseOf iao:0000136 ] ;
        owl:someValuesFrom :UseScenarioSpecification
      ]
    )
  ] .

# Relation labels (has role, inheres in) are declared in ARCO_core.ttl.
